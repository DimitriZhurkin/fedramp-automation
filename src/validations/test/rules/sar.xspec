<?xml version="1.0" encoding="UTF-8"?>

<x:description
    run-as="external"
    schematron="../../rules/sar.sch"
    xmlns:x="http://www.jenitennison.com/xslt/xspec">

    <x:scenario
        label="In FedRAMP OSCAL SAR">

        <x:scenario
            label="import-ap">

            <x:context>
                <assessment-results
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <import-ap
                        href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                    <back-matter>
                        <resource
                            uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                            <title>Security Assessment Plan</title>
                            <prop
                                name="type"
                                value="security-assessment-plan" />
                            <rlink
                                href="../../../../dist/content/templates/ssp/xml/FedRAMP-SAR-OSCAL-Template.xml"
                                media-type="text/xml" />
                        </resource>
                    </back-matter>
                </assessment-results>
            </x:context>

            <x:scenario
                label="when the import-ap element">

                <x:scenario
                    label="is present">
                    <x:expect-not-assert
                        id="has-import-ap"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="is absent">
                    <x:context>
                        <assessment-results
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <!-- missing import-ap -->
                        </assessment-results>
                    </x:context>
                    <x:expect-assert
                        id="has-import-ap"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="has an href attribute">
                    <x:expect-not-assert
                        id="has-import-ap-href"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="lacks an href attribute">
                    <x:context>
                        <assessment-results
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap /><!-- missing href -->
                        </assessment-results>
                    </x:context>
                    <x:expect-assert
                        id="has-import-ap-href"
                        label="that is an error" />
                </x:scenario>

            </x:scenario>

            <x:scenario
                label="when the import-ap has a relative href">
                <x:scenario
                    label="which refers to a resource">
                    <x:expect-not-assert
                        id="has-import-ap-internal-href"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="which does not refer to a resource">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                            <back-matter>
                                <!-- missing resource -->
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-import-ap-internal-href"
                        label="that is an error" />
                </x:scenario>
            </x:scenario>

            <x:scenario
                label="when the import-ap has an external href"
                pending="XSpec problem resolution">
                <x:scenario
                    label="which is available">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="file:/dev/null" />
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-import-ap-external-href"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="which is not available"
                    pending="XSpec problem resolution">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="file:x" />
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-import-ap-external-href"
                        label="that is an error" />
                </x:scenario>
            </x:scenario>

            <x:scenario
                label="when the import-ap has a relative href">
                <x:scenario
                    label="and the SSP is declared as a back-matter resource">
                    <x:expect-not-assert
                        id="has-security-assessment-plan-resource"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and the SSP is not declared as a back-matter resource">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                            <back-matter>
                                <!-- missing resource -->
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-security-assessment-plan-resource"
                        label="that is an error" />
                </x:scenario>
            </x:scenario>

            <x:scenario
                label="when there is a security-assessment-plan resource">

                <x:scenario
                    label="and it has one and only one rlink">
                    <x:expect-not-assert
                        id="has-sap-rlink"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="and it lacks an rlink">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                            <back-matter>
                                <resource
                                    uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                    <title>Security Assessment Plan</title>
                                    <prop
                                        name="type"
                                        value="security-assessment-plan" />
                                    <!-- missing rlink -->
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-sap-rlink"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="and it has more than one one rlink">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                            <back-matter>
                                <resource
                                    uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                    <title>Security Assessment Plan</title>
                                    <prop
                                        name="type"
                                        value="security-assessment-plan" />
                                    <rlink
                                        href="../../../../dist/content/templates/ssp/xml/FedRAMP-SAR-OSCAL-Template.xml"
                                        media-type="text/xml" />
                                    <rlink
                                        href="../../../../dist/content/templates/ssp/json/FedRAMP-SAR-OSCAL-Template.json"
                                        media-type="application/json" />
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-sap-rlink"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="and the rlink has an allowed media-type">
                    <x:expect-not-assert
                        id="has-acceptable-security-assessment-plan-rlink-media-type"
                        label="that is correct" />
                </x:scenario>
                <x:scenario
                    label="and the rlink lacks an allowed media-type">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                            <back-matter>
                                <resource
                                    uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                    <title>Security Assessment Plan</title>
                                    <prop
                                        name="type"
                                        value="security-assessment-plan" />
                                    <rlink
                                        href="../../../../dist/content/templates/ssp/xml/FedRAMP-SAR-OSCAL-Template.xml"
                                        media-type="text/markdown" />
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-acceptable-security-assessment-plan-rlink-media-type"
                        label="that is an error" />
                </x:scenario>

                <!-- TODO: 
                    Guide to OSCAL-based FedRAMP Security Assessment Plans (SAR) §3.5 allows base64
                    but it also uses href on base64 so may be bogus.
                    Pending base64 restriction until verified.
            -->
                <x:scenario
                    label="and it lacks a base64"
                    pending="base64 usage verification">
                    <x:expect-not-assert
                        id="has-no-base64"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="and it has a base64"
                    pending="base64 usage verification">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <import-ap
                                href="#bf974aa0-d662-4aef-a7a5-8f4cce398746" />
                            <back-matter>
                                <resource
                                    uuid="bf974aa0-d662-4aef-a7a5-8f4cce398746">
                                    <title>Security Assessment Plan</title>
                                    <prop
                                        name="type"
                                        value="security-assessment-plan" />
                                    <base64 />
                                </resource>
                            </back-matter>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-no-base64"
                        label="that is an error" />
                </x:scenario>

            </x:scenario>

        </x:scenario>
        
        <x:scenario
            label="results">
            <x:scenario
                label="when a result">
                <x:scenario
                    label="has an observation">
                    <x:scenario
                        label="with a type of 'operational-requirement'">
                        <x:scenario
                            label="and has a @uuid that matches a finding/related-observation/@observation-uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>operational-requirement</type>
                                        </observation>
                                        <finding uuid="170dd310-1a92-4fcf-a12b-ebfa03d9e6d8">
                                            <related-observation observation-uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6"/>
                                        </finding>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-operational-requirement-observation"
                                label="this is correct" />
                        </x:scenario>
                        <x:scenario
                            label="and does not have a @uuid that matches a finding/related-observation/@observation-uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>operational-requirement</type>
                                        </observation>
                                        <finding uuid="170dd310-1a92-4fcf-a12b-ebfa03d9e6d8">
                                            <related-observation observation-uuid="1234-1234"/>
                                        </finding>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-operational-requirement-observation"
                                label="this is incorrect" />
                        </x:scenario>
                        <x:scenario
                            label="and has a relevant-evidence/@href, whose value after the '#', matches a back-matter/resource/@uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>operational-requirement</type>
                                            <relevant-evidence href="#53af7193-b25d-4ed2-a82f-5954d2d0df61"/>
                                        </observation>
                                    </result>                                    
                                    <back-matter>
                                        <resource uuid="53af7193-b25d-4ed2-a82f-5954d2d0df61"/>
                                    </back-matter>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-operational-requirement-relevant-evidence"
                                label="this is correct" />
                        </x:scenario>
                        <x:scenario
                            label="and does not have a relevant-evidence/@href, whose value after the '#', matches a back-matter/resource/@uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>operational-requirement</type>
                                            <relevant-evidence href="#53af7193-b25d-4ed2-a82f-5954d2d0df61"/>
                                        </observation>
                                    </result>
                                    <back-matter>
                                        <resource uuid="1234-1234"/>
                                    </back-matter>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-operational-requirement-relevant-evidence"
                                label="this is incorrect" />
                        </x:scenario>
                    </x:scenario>
                    <x:scenario
                        label="with a type of 'risk-adjustment'">
                        <x:scenario
                            label="and has a @uuid that matches a finding/related-observation/@observation-uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>risk-adjustment</type>
                                        </observation>
                                        <finding uuid="170dd310-1a92-4fcf-a12b-ebfa03d9e6d8">
                                            <related-observation observation-uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6"/>
                                        </finding>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-risk-adjustment-observation"
                                label="this is correct" />
                        </x:scenario>
                        <x:scenario
                            label="and does not have a @uuid that matches a finding/related-observation/@observation-uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>risk-adjustment</type>
                                        </observation>
                                        <finding uuid="170dd310-1a92-4fcf-a12b-ebfa03d9e6d8">
                                            <related-observation observation-uuid="1234-1234"/>
                                        </finding>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-risk-adjustment-observation"
                                label="this is incorrect" />
                        </x:scenario>
                        <x:scenario
                            label="and has a relevant-evidence/link/@href, whose value after the '#', matches a back-matter/resource/@uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>risk-adjustment</type>
                                            <relevant-evidence>
                                                <link href="#53af7193-b25d-4ed2-a82f-5954d2d0df61"/>
                                            </relevant-evidence>
                                        </observation>
                                    </result>                                    
                                    <back-matter>
                                        <resource uuid="53af7193-b25d-4ed2-a82f-5954d2d0df61"/>
                                    </back-matter>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-risk-adjustment-relevant-evidence"
                                label="this is correct" />
                        </x:scenario>
                        <x:scenario
                            label="and does not have a relevant-evidence/link/@href, whose value after the '#', matches a back-matter/resource/@uuid">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="9de7cba9-40fc-4c4d-b6af-01bd24f1def6">
                                            <type>risk-adjustment</type>
                                            <relevant-evidence>
                                                <link href="#53af7193-b25d-4ed2-a82f-5954d2d0df61"/>
                                            </relevant-evidence>
                                        </observation>
                                    </result>
                                    <back-matter>
                                        <resource uuid="1234-1234"/>
                                    </back-matter>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-risk-adjustment-relevant-evidence"
                                label="this is incorrect" />
                        </x:scenario>
                    </x:scenario>
                    <x:scenario label="with a type of 'historic'">
                        <x:scenario label="and has a method of 'MIXED'">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                            <method>MIXED</method>
                                            <type>historic</type>
                                        </observation>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-method-MIXED"
                                label="that is correct" />
                        </x:scenario>
                        <x:scenario label="and does not have a method of 'MIXED'">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                            <method>TEST</method>
                                            <type>historic</type>
                                        </observation>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-method-MIXED"
                                label="that is incorrect" />
                        </x:scenario>
                    </x:scenario>
                    <x:scenario label="with a type of 'ssp-statement-issue'">
                        <x:scenario label="and has a method of 'EXAMINE'">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                            <method>EXAMINE</method>
                                            <type>ssp-statement-issue</type>
                                        </observation>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-type-ssp-statement-issue"
                                label="that is correct" />
                        </x:scenario>
                        <x:scenario label="and does not have a method of 'EXAMINE'">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                            <method>MIXED</method>
                                            <type>ssp-statement-issue</type>
                                        </observation>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-type-ssp-statement-issue"
                                label="that is incorrect" />
                        </x:scenario>
                        
                        <x:scenario label="and has a matching finding/related-observation/observation-uuid value">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                            <method>EXAMINE</method>
                                            <type>ssp-statement-issue</type>
                                        </observation>
                                        <finding uuid="33e43825-6fd7-49c6-a610-4c795954a167">
                                            <related-observation observation-uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308"/>
                                        </finding>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-type-ssp-statement-issue-matches-related-observation"
                                label="that is correct" />
                        </x:scenario>
                        <x:scenario label="and does not have a matching finding/related-observation/observation-uuid value">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation uuid="1234-1234">
                                            <method>EXAMINE</method>
                                            <type>ssp-statement-issue</type>
                                        </observation>
                                        <finding uuid="33e43825-6fd7-49c6-a610-4c795954a167">
                                            <related-observation observation-uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308"/>
                                        </finding>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-type-ssp-statement-issue-matches-related-observation"
                                label="that is incorrect" />
                        </x:scenario>
                        
                    </x:scenario>
                </x:scenario>
                <x:scenario
                    label="has an attestation">
                    <x:scenario
                        label="that has a property with a name of 'recommend-authorization'">
                        <x:context>
                            <assessment-results
                                xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                <result
                                    uuid="af0c8632-e994-48a7-924e-2354b6abace7">
                                    <attestation>
                                        <part
                                            name="authorization-statements">
                                            <prop
                                                name="recommend-authorization"
                                                ns="https://fedramp.gov/ns/oscal"
                                                value="yes" />
                                        </part>
                                    </attestation>
                                </result>
                            </assessment-results>
                        </x:context>
                        <x:expect-not-assert
                            id="has-attestation"
                            label="this is correct" />
                        <x:scenario
                            label="that has a value that is not 'yes'">
                            <x:scenario
                                label="and has a first part child with a first paragraph whose text matches the example in the Guide.">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <attestation>
                                                <part
                                                    name="authorization-statements">
                                                    <prop
                                                        name="recommend-authorization"
                                                        ns="https://fedramp.gov/ns/oscal"
                                                        value="no" />
                                                    <part
                                                        name="authorization-statement">
                                                        <prop
                                                            name="sort-id"
                                                            value="001" />
                                                        <p>A total of five system risks were identified for System ABC, including 2 High risks, one
                                                            Moderate risks, 2 Low risks, and zero of operationally required risks.</p>
                                                    </part>
                                                </part>
                                            </attestation>
                                        </result>
                                    </assessment-results>
                                </x:context>
                                <x:expect-not-assert
                                    id="has-attestation-value-no"
                                    label="this is correct" />
                            </x:scenario>
                            <x:scenario
                                label="and has a first part child with a first paragraph whose text does not match the example in the Guide.">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <attestation>
                                                <part
                                                    name="authorization-statements">
                                                    <prop
                                                        name="recommend-authorization"
                                                        ns="https://fedramp.gov/ns/oscal"
                                                        value="no" />
                                                    <part
                                                        name="authorization-statement">
                                                        <prop
                                                            name="sort-id"
                                                            value="001" />
                                                        <p>Priority levels were established based on [describe].</p>
                                                    </part>
                                                </part>
                                            </attestation>
                                        </result>
                                    </assessment-results>
                                </x:context>
                                <x:expect-assert
                                    id="has-attestation-value-no"
                                    label="this is incorrect" />
                            </x:scenario>
                        </x:scenario>
                    </x:scenario>
                    <x:scenario label="that does not have a property with a name of 'recommend-authorization'">
                        <x:context>
                            <assessment-results
                                xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                <result uuid="af0c8632-e994-48a7-924e-2354b6abace7">
                                    <attestation>
                                        <part name="authorization-statements">
                                            <prop ns="https://fedramp.gov/ns/oscal" name="authorized" value="yes"/>
                                        </part>
                                    </attestation>
                                </result>
                            </assessment-results>
                        </x:context>
                        <x:expect-assert
                            id="has-attestation"
                            label="this is incorrect" />
                    </x:scenario>
                </x:scenario>
                <x:scenario
                    label="has a risk">
                    <x:scenario
                        label="with a status of 'closed'">
                        <x:scenario
                            label="and has a risk-log/entry/status-change of 'closed'">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <risk
                                            uuid="ae628cc5-b64c-4030-af30-57e6b24a6ae7">
                                            <status>closed</status>
                                            <risk-log>
                                                <entry
                                                    uuid="0b09e341-cf3c-4de7-b728-751c6e88b653">
                                                    <status-change>closed</status-change>
                                                </entry>
                                            </risk-log>
                                        </risk>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-risk-log-status-closed"
                                label="this is correct" />
                        </x:scenario>
                        <x:scenario
                            label="and does not have a risk-log/entry/status-change of 'closed'">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <risk
                                            uuid="ae628cc5-b64c-4030-af30-57e6b24a6ae7">
                                            <status>closed</status>
                                            <risk-log>
                                                <entry
                                                    uuid="0b09e341-cf3c-4de7-b728-751c6e88b653">
                                                    <status-change>open</status-change>
                                                </entry>
                                            </risk-log>
                                        </risk>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-risk-log-status-closed"
                                label="this is incorrect" />
                        </x:scenario>
                    </x:scenario>
                    <x:scenario
                        label="with a prop of @name = 'priority'">
                        <x:scenario
                            label="and the @value of that prop is unique">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <risk
                                            uuid="ae628cc5-b64c-4030-af30-57e6b24a6ae7">
                                            <prop
                                                name="priority"
                                                ns="https://fedramp.gov/ns/oscal"
                                                value="3" />
                                        </risk>
                                        <risk
                                            uuid="ae628cc5-b64c-4030-af30-57e6b24a6ae8">
                                            <prop
                                                name="priority"
                                                ns="https://fedramp.gov/ns/oscal"
                                                value="5" />
                                        </risk>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-duplicate-priority-value"
                                label="this is correct" />
                        </x:scenario>
                        <x:scenario
                            label="and the @value of that prop is not unique">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <risk
                                            uuid="ae628cc5-b64c-4030-af30-57e6b24a6ae7">
                                            <prop
                                                name="priority"
                                                ns="https://fedramp.gov/ns/oscal"
                                                value="3" />
                                        </risk>
                                        <risk
                                            uuid="ae628cc5-b64c-4030-af30-57e6b24a6ae8">
                                            <prop
                                                name="priority"
                                                ns="https://fedramp.gov/ns/oscal"
                                                value="3" />
                                        </risk>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-duplicate-priority-value"
                                label="this is incorrect" />
                        </x:scenario>
                    </x:scenario>
                </x:scenario>
                <x:scenario
                    label="has an observation">
                    <x:scenario
                        label="of a type 'control-objective'">
                        <x:scenario label="and a method of 'EXAMINE'">
                            <x:scenario
                                label="and the subject's uuid matches a back-matter resource uuid">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <observation
                                                uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                                <method>EXAMINE</method>
                                                <type>control-objective</type>
                                                <subject
                                                    subject-uuid="f32b7ab1-baf1-451a-b3a1-1dfdadbe8dc7" />
                                            </observation>
                                        </result>
                                        <back-matter>
                                            <resource
                                                uuid="f32b7ab1-baf1-451a-b3a1-1dfdadbe8dc7" />
                                        </back-matter>
                                    </assessment-results>
                                </x:context>
                                <x:expect-not-assert
                                    id="has-subject-matching-resource-uuid"
                                    label="that is correct" />
                            </x:scenario>
                            <x:scenario
                                label="and the subject's uuid does not match a back-matter resource uuid">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <observation
                                                uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">                                             
                                                <method>EXAMINE</method>
                                                <type>control-objective</type>   
                                                <subject
                                                    subject-uuid="1234-1234" />
                                            </observation>
                                        </result>
                                        <back-matter>
                                            <resource
                                                uuid="f32b7ab1-baf1-451a-b3a1-1dfdadbe8dc7" />
                                        </back-matter>
                                    </assessment-results>
                                </x:context>
                                <x:expect-assert
                                    id="has-subject-matching-resource-uuid"
                                    label="that is incorrect" />
                            </x:scenario>
                        </x:scenario>
                    </x:scenario>
                    <x:scenario
                        label="and the method element">
                        <x:scenario
                            label="contains a correct string">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation
                                            uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                            <method>TEST</method>
                                        </observation>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-not-assert
                                id="has-correct-method-values"
                                label="that is correct" />
                        </x:scenario>
                        <x:scenario
                            label="does not contain a correct string">
                            <x:context>
                                <assessment-results
                                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                    <result>
                                        <observation
                                            uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                            <method>MIXED</method>
                                        </observation>
                                    </result>
                                </assessment-results>
                            </x:context>
                            <x:expect-assert
                                id="has-correct-method-values"
                                label="that is incorrect" />
                        </x:scenario>
                    </x:scenario>                    
                    <x:scenario
                        label="and the subject element">
                        <x:scenario label="has a type attribute">
                            <x:scenario
                                label="that contains a correct string">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <observation
                                                uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                                <subject type="component"/>
                                            </observation>
                                        </result>
                                    </assessment-results>
                                </x:context>
                                <x:expect-not-assert
                                    id="has-correct-subject-values"
                                    label="that is correct" />
                            </x:scenario>
                            <x:scenario
                                label="that does not contain a correct string">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <observation
                                                uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                                <subject type="mixed"/>
                                            </observation>
                                        </result>
                                    </assessment-results>
                                </x:context>
                                <x:expect-assert
                                    id="has-correct-subject-values"
                                    label="that is incorrect" />
                            </x:scenario>
                        </x:scenario>
                    </x:scenario>

                    <x:scenario
                        label="and the actor element">
                        <x:scenario label="has a type attribute">
                            <x:scenario
                                label="that contains a correct string">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <observation
                                                uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                                <actor type="party"/>
                                            </observation>
                                        </result>
                                    </assessment-results>
                                </x:context>
                                <x:expect-not-assert
                                    id="has-correct-actor-type"
                                    label="that is correct" />
                            </x:scenario>
                            <x:scenario
                                label="that does not contain a correct string">
                                <x:context>
                                    <assessment-results
                                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                                        <result>
                                            <observation
                                                uuid="d02f9117-84e3-4993-af59-c5ce5e8675ab">
                                                <actor type="mixed"/>
                                            </observation>
                                        </result>
                                    </assessment-results>
                                </x:context>
                                <x:expect-assert
                                    id="has-correct-actor-type"
                                    label="that is incorrect" />
                            </x:scenario>
                        </x:scenario>
                    </x:scenario>

                </x:scenario>
                
            </x:scenario>
        </x:scenario>

        
        <x:scenario
            label="age-checks">

            <!-- WARNING: The related checks depend on current-dateTime() -->
            <!-- These contexts will drift out of relevance unless updated -->

            <x:scenario
                label="when a result">

                <x:scenario
                    label="has an end">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-02T00:00:00Z</start>
                                <end>2022-05-06T00:00:00Z</end>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="assessment-has-ended"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="lacks an end">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-02T00:00:00Z</start>
                                <!--<end>2022-05-06T00:00:00Z</end>-->
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="assessment-has-ended"
                        label="that is a warning" />
                </x:scenario>

                <x:scenario
                    label="has start prior to end">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-02T00:00:00Z</start>
                                <end>2022-05-06T00:00:00Z</end>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="start-precedes-end"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="has end prior to start">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-06T00:00:00Z</start>
                                <end>2022-05-02T00:00:00Z</end>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="start-precedes-end"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="has contemporary assessment">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-02T00:00:00Z</start>
                                <end>2022-05-06T00:00:00Z</end>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-contemporary-assessment"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="lacks contemporary assessment">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2021-05-02T00:00:00Z</start>
                                <end>2021-05-06T00:00:00Z</end>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-contemporary-assessment"
                        label="that is an error" />
                </x:scenario>

                <x:scenario
                    label="has recent observation">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-02T00:00:00Z</start>
                                <end>2022-05-06T00:00:00Z</end>
                                <observation
                                    uuid="f0a94298-dd1e-4462-b63c-db80d7baaf96">
                                    <collected>2022-05-04T12:00:00Z</collected>
                                </observation>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="result-observations-are-recent"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="lacks recent observation">
                    <x:context>
                        <assessment-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <result
                                uuid="23b7ebf2-9bc2-4bc4-bcf6-022443117308">
                                <start>2022-05-02T00:00:00Z</start>
                                <end>2022-05-06T00:00:00Z</end>
                                <observation
                                    uuid="f0a94298-dd1e-4462-b63c-db80d7baaf96">
                                    <collected>2021-05-04T00:00:00Z</collected>
                                </observation>
                            </result>
                        </assessment-plan>
                    </x:context>
                    <x:expect-assert
                        id="result-observations-are-recent"
                        label="that is an error" />
                </x:scenario>

            </x:scenario>

        </x:scenario>

    </x:scenario>

</x:description>
